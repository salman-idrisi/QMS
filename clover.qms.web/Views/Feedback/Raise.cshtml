@using System.Web.Optimization;
@using clover.qms.web.Models;
@model clover.qms.model.Feedback
@{
    Layout = null;

    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")

}
<title>Quality Feedback</title>
<link rel="shortcut icon" href="/Images/clover.png">
<h2>Customer Feedback Form</h2>
<style>
    table, th, tr, td {
        border: 1px solid black;
    }

    .form-control1 {
        width: 750px;
    }

    p {
        font-size: 14px;
    }
</style>
<link href="@Url.ContentAbsUrl("~/Content/bootstrap-datepicker.css")" rel="stylesheet" />
<link href="@Url.ContentAbsUrl("~/Content/buttons.css")" rel="stylesheet" />
<script src="@Url.ContentAbsUrl("~/Scripts/CheckBox.js")"></script>
<body>
    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()


        <table style="width:100%;">
            <tr>
                <td style="background-color: #D3D3D3; padding-left:3px;">Company Organization</td>
                <td style="padding-left: 5px;">@Html.DisplayFor(model => model.cm.customerorganization)</td>

            </tr>
            <tr>
                <td style="background-color: #D3D3D3; padding-left: 3px;">Project ID</td>
                <td style="padding-left: 5px;">@Html.DisplayFor(model => model.pid)</td>
                @*<td>@TempData["id"]</td>*@
                @Html.HiddenFor(model => model.pid)
            </tr>

            <tr>
                <td style="background-color: #D3D3D3; padding-left: 3px;">Project Name</td>
                <td style="padding-left: 5px;">@Html.DisplayFor(model => model.cm.pm.ProjectName)</td>
                @* this was showing <td>@TempData["ProjectName"]</td> *@
            </tr>
            <tr>
                <td style="background-color: #D3D3D3; padding-left: 3px;">Customer Representative’s Name</td>
                <td style="padding-left: 5px;">@Html.DisplayFor(model => model.customerName)</td>
            </tr>
            <tr>
                <td style="background-color: #D3D3D3; padding-left: 3px;">Customer Representative’s Designation</td>
                <td style="padding-left: 5px;">@Html.DisplayFor(model => model.customerDesignation)</td>
            </tr>
            @*        @Html.DisplayFor(model=>model.cind,new {Value=})*@
            <tr>
                <td style="background-color: #D3D3D3; padding-left: 3px;">Project Type</td>
                <td style="padding-left: 5px;">@Html.DisplayFor(model => model.ptype)</td>
            </tr>
            <tr>
                <td style="background-color: #D3D3D3; padding-left: 3px;">Project Technology</td>
                @*this is also showing <td>@TempData["ProjectTechnology"]</td>*@
                <td style="padding-left: 5px;">@Html.DisplayFor(model => model.cm.ptname)</td>
            </tr>
            <tr>
                <td style="background-color: #D3D3D3; padding-left: 3px;">Location (if applicable)</td>
                <td style="padding-left: 5px;">Mumbai</td>
            </tr>
        </table>
        <br />
        <table>
            <tr>
                <td style="background-color:#D3D3D3; width:200px; padding-left:3px;"><b>Feedback for the Period</b></td>
                <td style="background-color:#D3D3D3; width:100px;" align="center"><b>From</b></td>
                @* <td style="width:100px;" align="center">@Html.DisplayFor(model => model.cm.pm.startdate)</td>*@
                <td style="width:100px;" align="center">
                    <input type="text" class="form-control date-picker" required data-format="dd/MM/yyyy hh:mm:ss" data-bv-date-message="Please enter Valid Date "
                           placeholder="dd-mmm-yy" name="startdate" id="startdate" autocomplete="off" data-val="true" data-val-required="The start date is required" />

                </td>
                <td style="background-color:#D3D3D3; width:100px;" align="center"><b>To</b></td>
                <td style="width:100px;" align="center">
                    <input type="text" class="form-control date-picker" required data-format="dd/MM/yyyy hh:mm:ss" data-bv-date-message="Please enter Valid Date "
                           placeholder="dd-mmm-yy" name="enddate" id="enddate" autocomplete="off" data-val="true" data-val-required="The end date is required" />
                </td>


            </tr>
        </table>
        <br />
        <p style="text-align:left"><strong>Dear @Html.DisplayFor(model => model.customerName)</strong></p>
        <p>
            In the process to serve you better, we have designed this form to collect information about your satisfaction level on the current project.
            Your valuable feedback will help us to know your views and meet / exceed expectations for the future work.

        </p>

        <b>Quality Feedback</b>
        <div style="width:370px; border:1px solid black; font-size:14px; padding-left:5px">

            The parameters are grouped in delivery quality & service related.
            Performance Rating for the above parameters to be given based on the
            Satisfaction Level as mentioned below:


            <table style="border:none;">
                <tr style="border:none;">
                    <td style="border:none;"><b><u>Rating</u></b>&nbsp;&nbsp;&nbsp;</td>
                    <td style="border:none;"><b><u>Rating Description</u></b></td>
                </tr>
                <tr style="border:none;">
                    <td style="border:none;" align="center"><b>5</b>&nbsp;&nbsp;&nbsp;</td>
                    <td style="border:none;">Most significant expectations met and many exceeded&nbsp;&nbsp;&nbsp;</td>
                </tr>
                <tr style="border:none;">
                    <td style="border:none;" align="center"><b>4</b>&nbsp;&nbsp;&nbsp;</td>
                    <td style="border:none;">Met most expectations&nbsp;&nbsp;&nbsp;</td>
                </tr>
                <tr style="border:none;">
                    <td style="border:none;" align="center"><b>3</b>&nbsp;&nbsp;&nbsp;</td>
                    <td style="border:none;">Satisfactory work done, need improvements in some areas&nbsp;&nbsp;&nbsp;</td>
                </tr>
                <tr style="border:none;">
                    <td style="border:none;" align="center"><b>2</b>&nbsp;&nbsp;&nbsp;</td>
                    <td style="border:none;">Some expectations met, considerable improvements needed&nbsp;&nbsp;&nbsp;</td>
                </tr>
                <tr style="border:none;">
                    <td style="border:none;" align="center"><b>1</b>&nbsp;&nbsp;&nbsp;</td>
                    <td style="border:none;">Not satisfactory, need substantial improvements &nbsp;&nbsp;&nbsp;</td>
                </tr>

                <tr style="border:none;">
                    <td style="border:none;"><b>Blank/0 </b>&nbsp;&nbsp;&nbsp;</td>
                    <td style="border:none;">Not Applicable &nbsp;&nbsp;&nbsp;</td>

            </table>

        </div>
        <br />
        <b style="text-decoration:underline; font-size:14px;">Quality Feedback</b>
        <br />
        <br />

        <div style="border:1px solid black; font-size:14px; padding:5px; width:900px;">
            <b>Section A ( Customer Satisfaction Rating )</b> contains questions 1,2,3<br />
            <ax style="margin-left:50px;">OVERALL CUSTOMER Satisfaction Rating will be based on the ratings of section A.</ax><br />
            <b>Section B ( Feedback )</b>contains questions 4,5,6.<br />
            <ax style="margin-left:50px;">Your response to these questions will help us in understanding your  requirements & expectations better and tune our services.</ax><br />
            <b>Section C ( Optional)</b> contains question 7.<br />
            <ax style="margin-left:50px;">This Optional section can be used for additional feedback parameters that is felt necessary for feedback.</ax><br />
        </div>
        <br />



        <div class="form-horizontal">
            <table>
                <tr>
                    <th>
                        Sr. No.
                    </th>
                    <th>
                        Parameters for Rating
                    </th>
                    <th>
                        Performance Rating
                    </th>
                    <th>
                        Please elaborate with examples & comments, if rating < 3.5
                    </th>
                </tr>
                <tr>
                    <th>
                        A)
                    </th>
                    <th>
                        CUSTOMER SATISFACTION RATING
                    </th>
                    <th>

                    </th>
                    <th>
                        < Overall CSAT Rating computed only on Section (A)
                    </th>

                </tr>
                @{var srNo = 1; var counter = 0;

                    foreach (var item in Model.csatParameter)
                    {
                        <tr style="background-color:#D3D3D3;">
                            <td>@srNo</td>
                            <td>
                                @item.parameterName
                            </td>
                            <td>
                            </td>
                            <td>
                            </td>

                        </tr>

                        var srNo2 = 1;
                        foreach (var item1 in Model.csatSubParameter)
                        {

                            if (item1.parameterId == item.parameterId)
                            {
            <tr>
                <td>@srNo. @srNo2</td>
                <td>@item1.subParameterName</td>
                @*<td onchange=checkval(@counter)>@Html.EditorFor(model => model.ratings[counter], new { htmlAttributes = new { @id = "textbox" + counter, @class = "form-control1" } })</td>*@

                @{
                    //Added by Asees on 17/11/22

                    List<SelectListItem> sl = new List<SelectListItem>();


                    sl.Add(new SelectListItem { Text = "1", Value = "1" });
                    sl.Add(new SelectListItem { Text = "2", Value = "2" });
                    sl.Add(new SelectListItem { Text = "3", Value = "3" });
                    sl.Add(new SelectListItem { Text = "4", Value = "4" });
                    sl.Add(new SelectListItem { Text = "5", Value = "5" });


                }

                @*Commented by Asees on 29/11/22 TD of Onchange*@

                <td onchange=checkval(@counter)>@Html.EditorFor(model => model.ratings[counter], new { htmlAttributes = new { @id = "textbox" + counter, @class = "form-control1", @placeholder = "Enter Rating Between 1 - 5", @type = "number", @ontextchange= "checkval("+counter+")" } })</td>

                @*<td onchange=checkval(@counter)>

            @Html.DropDownListFor(model => model.ratings[counter],sl,new { htmlAttributes = new { @id = "textbox" + counter, @class = "form-control1", @style = "Width:100%" } })
        </td>*@


                <td onchange=checkval(@counter)>@Html.EditorFor(model => model.description[counter], new { htmlAttributes = new { @id = "textbox2" + counter, @class = "form-control1" } })</td>
                @*,Style = "box-shadow:1px 1px 10px red"*@
                @Html.HiddenFor(model => model.csatSubParameter[counter].parameterId)
                @Html.HiddenFor(model => model.csatSubParameter[counter].csatsubparameterId)
                @* id = Model.Option[i].OptionId, onchange = "StateChange()"*@

            </tr>
                                counter++;
                                srNo2++;
                            }
                        }

                        srNo++;
                    }
                    @Html.HiddenFor(model => model.pid)
                }
            </table>
            <br />

            <table>
                <tr>
                    <td style="background-color:#D3D3D3;width:200px;" align="right"><b>Filled by:</b></td>
                    <td style="width:200px;" align="center">@Html.DisplayFor(model => model.customerName)</td>
                </tr>
                <tr>
                    <td style="background-color:#D3D3D3;width:200px;" align="right"><b>Date:</b></td>
                    @* <td style="width:200px;" align="center">@DateTime.Now.ToShortDateString() </td>*@
                    @*<td style="width:200px;" align="center"></td>*@


                    <td style="width:200px;" align="center">@DateTime.Today.ToString("dd/MMM/yyyy")</td>

                    @Html.HiddenFor(model => model.datefilled, new { Value = DateTime.Today.ToString("dd/MMM/yyyy") })
                </tr>

            </table>
        </div>
        <br />
        <p>
            Thank you for your  time and effort to fill this form.
            <br />
            Your feedback is greatly appreciated.
        </p>

        <table>
            <tr>
                <td style="background-color:#D3D3D3;width:200px;" align="right"><b>Project Manager Name</b></td>
                <td style="width:200px" align="center">@Html.DisplayFor(model => model.pmanager)</td>
            </tr>
        </table>
        <br />
        <p align="center">
            <input type="submit" value="Submit" onclick="return confirm('Are you sure you want to submit the feedback');" class="btn btn-success" />
        </p>
    }
</body>
<script>
    function checkval(id) {
        debugger;
        if (document.getElementById("textbox" + id).value <= 3.5 && document.getElementById("textbox" + id).value > 0 && document.getElementById("textbox2" + id).value == '') {
            document.getElementById("textbox2" + id).style.border = "solid 2px #FF0000";
            document.getElementById("textbox2" + id).required = true;
            document.getElementById("textbox2" + id).placeholder = "Enter Remarks";


        }
        else if (document.getElementById("textbox" + id).value <= 3.5 && document.getElementById("textbox" + id).value > 0 && document.getElementById("textbox2" + id).value != '') {
            document.getElementById("textbox2" + id).style.border = "none";
            // document.getElementById("textbox2" + id).required = false;

        }
        else {

            // Added by Asees on 29/11/22 
            var txtRatings = document.getElementById("textbox" + id);
            debugger;
            if ( txtRatings.value <= 0 || txtRatings.value>5)
            {
                
                txtRatings.value = '1';
            }

            document.getElementById("textbox2" + id).style.border = "none";
            document.getElementById("textbox" + id).max = 5;
            document.getElementById("textbox" + id).min = 1;
            document.getElementById("textbox2" + id).required = false;
            document.getElementById("textbox2" + id).placeholder = " ";


        }
    }

    // Added by Asees on 29/11/22 
    //function checkData()
    //{
    //    var fromDate = document.getElementById("startdate");
    //    var toDate = document.getElementById("enddate");
    //    var currentDate = Date.now

    //    if (toDate < fromDate)
    //    {

    //        alert("startDate cannot be more than end date");
    //        return false;

    //    }
    //    else if ()
    //    {

    //    }
    //}

</script>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
